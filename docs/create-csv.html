<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 4 Create .csv | Automated Gating of Flow Cytometry Data using the Bioconductor openCyto Framework</title>
  <meta name="description" content="This tutorial was created to allow users to automate flow cytometry analysis in R using the openCyto package. The tutorial includes steps to complete automation from a flowJo Workspace file. Full details on tutorial contents are included in the following chapters.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 4 Create .csv | Automated Gating of Flow Cytometry Data using the Bioconductor openCyto Framework" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This tutorial was created to allow users to automate flow cytometry analysis in R using the openCyto package. The tutorial includes steps to complete automation from a flowJo Workspace file. Full details on tutorial contents are included in the following chapters." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Create .csv | Automated Gating of Flow Cytometry Data using the Bioconductor openCyto Framework" />
  
  <meta name="twitter:description" content="This tutorial was created to allow users to automate flow cytometry analysis in R using the openCyto package. The tutorial includes steps to complete automation from a flowJo Workspace file. Full details on tutorial contents are included in the following chapters." />
  

<meta name="author" content="Nichole Monhait, MPH Candidate">
<meta name="author" content="Colorado School of Public Health, Colorado State University">


<meta name="date" content="2019-05-07">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="working-with-your-manual-gating-scheme.html">
<link rel="next" href="automate-gating.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Automated Gating of Flow Cytometry Data using the Bioconductor `openCyto` Frameworke</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> What’s inside?</a></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#function-and-r-object-definitions"><i class="fa fa-check"></i><b>2.1</b> Function and R Object Definitions</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#required-packages-and-installation"><i class="fa fa-check"></i><b>2.2</b> Required Packages and Installation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="working-with-your-manual-gating-scheme.html"><a href="working-with-your-manual-gating-scheme.html"><i class="fa fa-check"></i><b>3</b> Working with your Manual Gating Scheme</a><ul>
<li class="chapter" data-level="3.1" data-path="working-with-your-manual-gating-scheme.html"><a href="working-with-your-manual-gating-scheme.html#read-in-flowjo-file"><i class="fa fa-check"></i><b>3.1</b> Read in flowJo file</a></li>
<li class="chapter" data-level="3.2" data-path="working-with-your-manual-gating-scheme.html"><a href="working-with-your-manual-gating-scheme.html#parse-fcs-files"><i class="fa fa-check"></i><b>3.2</b> Parse FCS files</a></li>
<li class="chapter" data-level="3.3" data-path="working-with-your-manual-gating-scheme.html"><a href="working-with-your-manual-gating-scheme.html#visualize-and-verify"><i class="fa fa-check"></i><b>3.3</b> Visualize and Verify</a><ul>
<li class="chapter" data-level="3.3.1" data-path="working-with-your-manual-gating-scheme.html"><a href="working-with-your-manual-gating-scheme.html#plot"><i class="fa fa-check"></i><b>3.3.1</b> plot()</a></li>
<li class="chapter" data-level="3.3.2" data-path="working-with-your-manual-gating-scheme.html"><a href="working-with-your-manual-gating-scheme.html#plotgate"><i class="fa fa-check"></i><b>3.3.2</b> plotGate()</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="working-with-your-manual-gating-scheme.html"><a href="working-with-your-manual-gating-scheme.html#clone"><i class="fa fa-check"></i><b>3.4</b> Clone</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="create-csv.html"><a href="create-csv.html"><i class="fa fa-check"></i><b>4</b> Create .csv</a><ul>
<li class="chapter" data-level="4.1" data-path="create-csv.html"><a href="create-csv.html#csv-gating-template-structure"><i class="fa fa-check"></i><b>4.1</b> .csv Gating Template Structure</a><ul>
<li class="chapter" data-level="4.1.1" data-path="create-csv.html"><a href="create-csv.html#template-columns"><i class="fa fa-check"></i><b>4.1.1</b> Template Columns</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="create-csv.html"><a href="create-csv.html#creating-the-template"><i class="fa fa-check"></i><b>4.2</b> Creating the Template</a></li>
<li class="chapter" data-level="4.3" data-path="create-csv.html"><a href="create-csv.html#load-.csv-into-r"><i class="fa fa-check"></i><b>4.3</b> Load .csv into R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="automate-gating.html"><a href="automate-gating.html"><i class="fa fa-check"></i><b>5</b> Automate Gating</a><ul>
<li class="chapter" data-level="5.1" data-path="automate-gating.html"><a href="automate-gating.html#apply-gating"><i class="fa fa-check"></i><b>5.1</b> Apply Gating</a></li>
<li class="chapter" data-level="5.2" data-path="automate-gating.html"><a href="automate-gating.html#plot-automated-gating"><i class="fa fa-check"></i><b>5.2</b> Plot Automated Gating</a></li>
<li class="chapter" data-level="5.3" data-path="automate-gating.html"><a href="automate-gating.html#population-statistics"><i class="fa fa-check"></i><b>5.3</b> Population Statistics</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="customization.html"><a href="customization.html"><i class="fa fa-check"></i><b>6</b> Customization</a><ul>
<li class="chapter" data-level="6.1" data-path="customization.html"><a href="customization.html#hiding-unwanted-nodes"><i class="fa fa-check"></i><b>6.1</b> Hiding unwanted nodes</a></li>
<li class="chapter" data-level="6.2" data-path="customization.html"><a href="customization.html#renaming-nodes"><i class="fa fa-check"></i><b>6.2</b> Renaming nodes</a></li>
<li class="chapter" data-level="6.3" data-path="customization.html"><a href="customization.html#adjusting-plots"><i class="fa fa-check"></i><b>6.3</b> Adjusting plots</a><ul>
<li class="chapter" data-level="6.3.1" data-path="customization.html"><a href="customization.html#adjust-plot-axes"><i class="fa fa-check"></i><b>6.3.1</b> Adjust plot axes</a></li>
<li class="chapter" data-level="6.3.2" data-path="customization.html"><a href="customization.html#transform-data-for-better-visualization"><i class="fa fa-check"></i><b>6.3.2</b> Transform data for better visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Automated Gating of Flow Cytometry Data using the Bioconductor <code>openCyto</code> Framework</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="create-.csv" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Create .csv</h1>
<p>The creation of a .csv gating template is arguably the most important step to automating flow cytometry analysis. The .csv template that you create will tell <code>openCyto</code> how to gate your data. Gating methods that are support currently by <code>openCyto</code> include:</p>
<p><em>quadrantGate<br />
</em>rangeGate<br />
<em>quantileGate<br />
</em>mindensity<br />
<em>tailgate<br />
</em>cytokine<br />
<em>flowClust<br />
</em>boundary<br />
<em>singletGate<br />
</em>transitional<br />
<em>plolyfunctionalityGate<br />
</em>flowDensity</p>
<div id="csv-gating-template-structure" class="section level2">
<h2><span class="header-section-number">4.1</span> .csv Gating Template Structure</h2>
<p>In the gating template, each row corresponds to a single cell population and the method used to gate that population. The .csv must contain 10 predefined columns that will be listed below. Most cell population names listed in columns must be uniquely and follow certain guidelines. These include:</p>
<p><em>unique idenitifer for <code>alias</code> and <code>parent</code> columns<br />
</em>no commas in <code>parent</code> columns (otherwise <code>opencyto</code> will assume the population has multiple parents)<br />
*restrict <code>pop</code> column to quadrant-only strings (++,+)</p>
<p>The required 10 columns are explained below.</p>
<div id="template-columns" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Template Columns</h3>
<p><code>alias</code>- unique name/identifier for cell population<br />
<code>pop</code>- +/- pattern to determine which subset or quadrant will be gated<br />
<code>parent</code>- unique identifier for the parent population<br />
<code>dims</code>- channel or marker names for gating<br />
<code>gating_method</code>- gating function (supported options listed above)<br />
<code>gating_args</code>- arguments to be passed to gating function
<code>collapseDataforGating</code>- data is collapsed and replicated across all samples<br />
<code>groupBy</code>- used to group samples into unique combinations<br />
<code>preprocessing_method</code>- preprocessing function<br />
<code>preprocessing_args</code>- arguments for preprocessing function</p>
</div>
</div>
<div id="creating-the-template" class="section level2">
<h2><span class="header-section-number">4.2</span> Creating the Template</h2>
<p>The gating template can be created manually or assisted by the use of the <code>templateGen()</code> function. <code>TemplateGen()</code> will auto-fill the <code>alias</code>, <code>pop</code>, <code>parent</code>, and <code>dims</code> columns and the rest must be completed manually. To use <code>templateGen()</code>, you must input a GatingHierarchy object. In this example, that is <strong>gh</strong>, the subset created from <strong>gating_set</strong>.</p>
<pre class="sourceCode r"><code class="sourceCode r">gt &lt;-<span class="st"> </span><span class="kw">templateGen</span>(gh)
<span class="kw">head</span>(gt)</code></pre>
<pre><code>##        alias        pop                              parent
## 1   Singlets   Singlets                                root
## 2       Live       Live                           /Singlets
## 3 Leukocytes Leukocytes                      /Singlets/Live
## 4       CD3+       CD3+           /Singlets/Live/Leukocytes
## 5       CD8+       CD8+      /Singlets/Live/Leukocytes/CD3+
## 6     CXCR1-     CXCR1- /Singlets/Live/Leukocytes/CD3+/CD8+
##                           dims gating_method gating_args
## 1                  FSC-A,FSC-H          &lt;NA&gt;        &lt;NA&gt;
## 2            Comp-Zombie Nir-A          &lt;NA&gt;        &lt;NA&gt;
## 3                  FSC-A,SSC-A          &lt;NA&gt;        &lt;NA&gt;
## 4 Comp-Alexa Fluor 532-A,SSC-H          &lt;NA&gt;        &lt;NA&gt;
## 5           Comp-BV570-A,SSC-H          &lt;NA&gt;        &lt;NA&gt;
## 6                    Comp-PE-A          &lt;NA&gt;        &lt;NA&gt;
##   collapseDataForGating groupBy preprocessing_method preprocessing_args
## 1                  &lt;NA&gt;    &lt;NA&gt;                 &lt;NA&gt;               &lt;NA&gt;
## 2                  &lt;NA&gt;    &lt;NA&gt;                 &lt;NA&gt;               &lt;NA&gt;
## 3                  &lt;NA&gt;    &lt;NA&gt;                 &lt;NA&gt;               &lt;NA&gt;
## 4                  &lt;NA&gt;    &lt;NA&gt;                 &lt;NA&gt;               &lt;NA&gt;
## 5                  &lt;NA&gt;    &lt;NA&gt;                 &lt;NA&gt;               &lt;NA&gt;
## 6                  &lt;NA&gt;    &lt;NA&gt;                 &lt;NA&gt;               &lt;NA&gt;</code></pre>
<p>The auto-filled template will generate within the R Console and can then be saved locally with the following code.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.csv</span>(gt, <span class="st">&quot;gt.csv&quot;</span>)</code></pre>
<p>If you choose to create the gating template manually, the same conventions must be followed. Start with a blank spreadsheet. Next, fill in the 10 required column names. From there, use the manual gating hierarchy to fill in each cell population <code>alias</code>. Fill in the remainder accordingly.</p>
<p>There will likely be troubleshooting involved in this process. <a href="https://www.bioconductor.org/packages/devel/bioc/vignettes/openCyto/inst/doc/HowToWriteCSVTemplate.html#14_gating_method_that_generates_multiple_populations">This</a> is a great place to start if you’re seeking more information on the gating template. The <code>openCyto</code> <a href="https://github.com/RGLab/openCyto">GitHub page</a> is also very responsive to issues posted.</p>
</div>
<div id="load-.csv-into-r" class="section level2">
<h2><span class="header-section-number">4.3</span> Load .csv into R</h2>
<p>There is a sample gating template titled <em>partial.csv</em> with the sample data. This may serve as a guide to creating your own. When the .csv gating template is complete, it is then read into R and saved as <strong>gt</strong>. The gating template will be saved as a GatingTemplate object.</p>
<pre class="sourceCode r"><code class="sourceCode r">gt &lt;-<span class="st"> </span><span class="kw">gatingTemplate</span>(<span class="st">&quot;/Users/monhait/Desktop/flow_cyto/automated_gating/data/gating_template/partial.csv&quot;</span>)
<span class="kw">print</span>(gt)</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-your-manual-gating-scheme.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="automate-gating.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown_autogating.pdf", "bookdown_autogating.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
